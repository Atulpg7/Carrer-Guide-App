package com.careerguide;import android.app.AlertDialog;import android.app.ProgressDialog;import android.content.ActivityNotFoundException;import android.content.Intent;import android.net.Uri;import android.os.Bundle;import android.support.v4.app.Fragment;import android.util.Log;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.Button;import android.widget.TextView;import android.widget.Toast;import android.widget.Toolbar;import com.android.volley.AuthFailureError;import com.android.volley.Request;import com.android.volley.Response;import com.android.volley.VolleyError;import com.android.volley.toolbox.StringRequest;import org.json.JSONException;import org.json.JSONObject;import java.util.HashMap;import java.util.Map;/** * A simple {@link Fragment} subclass. */public class ContactUsFragment extends Fragment {	public ContactUsFragment() {		// Required empty public constructor	}	@Override	public View onCreateView(LayoutInflater inflater, ViewGroup container,							 Bundle savedInstanceState) {		// Inflate the layout for this fragment		View view = inflater.inflate(R.layout.fragment_contact_us, container, false);		View.OnClickListener callListener = new View.OnClickListener() {			@Override			public void onClick(View v) {//                Intent intent = new Intent(Intent.ACTION_DIAL, Uri.parse("tel:" + "011 66487704"));				Intent intent = new Intent(Intent.ACTION_DIAL, Uri.parse("tel:" + "+91 8800442358"));				startActivity(intent);			}		};		view.findViewById(R.id.call).setOnClickListener(callListener);		view.findViewById(R.id.callText).setOnClickListener(callListener);		View.OnClickListener messangerListener = new View.OnClickListener() {			@Override			public void onClick(View v) {				Intent intent = new Intent();				intent.setAction(Intent.ACTION_SEND);				intent.putExtra(Intent.EXTRA_TEXT, "");				intent.setType("text/plain");				intent.setPackage("com.facebook.orca");				try {					startActivity(intent);				}				catch (ActivityNotFoundException ex)				{					Toast.makeText(getActivity(),"Please Install Facebook Messenger",Toast.LENGTH_LONG).show();				}			}		};        /*view.findViewById(R.id.messanger).setOnClickListener(messangerListener);        view.findViewById(R.id.messangerText).setOnClickListener(messangerListener);*/		view.findViewById(R.id.email).setOnClickListener(new View.OnClickListener() {			@Override			public void onClick(View v) {				Intent emailIntent = new Intent(Intent.ACTION_SENDTO, Uri.fromParts(						"mailto","customercare@careerguide.com", null));                /*emailIntent.putExtra(Intent.EXTRA_SUBJECT, "Subject");                emailIntent.putExtra(Intent.EXTRA_TEXT, "Body");*/				startActivity(Intent.createChooser(emailIntent, "Send email..."));			}		});		view.findViewById(R.id.fbLink).setOnClickListener(new View.OnClickListener() {			@Override			public void onClick(View v) {				String url = "https://www.facebook.com/CareerGuide2015/";				Intent i = new Intent(Intent.ACTION_VIEW);				i.setData(Uri.parse(url));				startActivity(i);			}		});		view.findViewById(R.id.linkedInLink).setOnClickListener(new View.OnClickListener() {			@Override			public void onClick(View v) {				String url = "https://www.linkedin.com/company/careerguide-com/";				Intent i = new Intent(Intent.ACTION_VIEW);				i.setData(Uri.parse(url));				startActivity(i);			}		});		view.findViewById(R.id.twitterLink).setOnClickListener(new View.OnClickListener() {			@Override			public void onClick(View v) {				String url = "https://twitter.com/_CareerGuide";				Intent i = new Intent(Intent.ACTION_VIEW);				i.setData(Uri.parse(url));				startActivity(i);			}		});		view.findViewById(R.id.leaveQuery).setOnClickListener(new View.OnClickListener() {			@Override			public void onClick(View v) {				final View queryView = getActivity().getLayoutInflater().inflate(R.layout.dialog_contact_us_mail,null);				final AlertDialog adb = new AlertDialog.Builder(getActivity()).create();				adb.setView(queryView);				adb.show();				final TextView nameTextView = queryView.findViewById(R.id.nameContactUs);				final TextView mobileTextView = queryView.findViewById(R.id.mobileContactUs);				final TextView messageTextView = queryView.findViewById(R.id.messageContactUs);				Button submitButton = queryView.findViewById(R.id.submitContactUs);				submitButton.setOnClickListener(new View.OnClickListener() {					@Override					public void onClick(View v) {						final String name = nameTextView.getText().toString().trim();						final String mobile = mobileTextView.getText().toString().trim();						final String message = messageTextView.getText().toString().trim();						if (name.length() == 0 || mobile.length() == 0 || message.length() == 0)						{							Toast.makeText(getActivity(),"Please fill all fields.",Toast.LENGTH_LONG).show();						}						else						{							final ProgressDialog progressDialog = new ProgressDialogCustom(getActivity(), "Sending query...");							progressDialog.show();							StringRequest stringRequest = new StringRequest(Request.Method.POST, Utility.PRIVATE_SERVER + "contact_us", new Response.Listener<String>() {								@Override								public void onResponse(String response){									progressDialog.dismiss();									Log.e("contact_us_response",response);									try									{										JSONObject jsonObject = new JSONObject(response);										boolean status = jsonObject.optBoolean("status",false);										if(status)										{											if (isAdded())											{												adb.dismiss();												Toast.makeText(getActivity(),"Query Sent.",Toast.LENGTH_LONG).show();											}											//user exist										}										else										{											Toast.makeText(getActivity(),"Something went wrong.",Toast.LENGTH_LONG).show();										}									} catch (JSONException e) {										e.printStackTrace();									}								}							}, new Response.ErrorListener()							{								@Override								public void onErrorResponse(VolleyError error) {									progressDialog.dismiss();									Toast.makeText(getActivity(),VoleyErrorHelper.getMessage(error,getActivity()),Toast.LENGTH_LONG).show();									//Log.e("user_exist_error","error");								}							})							{								@Override								protected Map<String, String> getParams() throws AuthFailureError {									HashMap<String,String> params = new HashMap<>();									params.put("name",name);									params.put("mobile_number",mobile);									params.put("msg",message);									Log.e("request",params.toString());									return params;								}							};							VolleySingleton.getInstance(getActivity()).addToRequestQueue(stringRequest);						}					}				});			}		});		return view;	}}